# ========================================
# SSL/TLS Hardening Configuration
# ========================================
# Auto-generated by Nginx Manager
# Included in nginx.conf via: include /etc/nginx/conf.d/*.conf;

# OCSP Stapling Configuration
# Improves SSL/TLS handshake performance and privacy
ssl_stapling on;
ssl_stapling_verify on;

# Note: DNS resolver already configured in main nginx.conf (line 14)
# resolver 127.0.0.11 valid=10s ipv6=off;

# SSL Buffer Size (optimize for performance)
ssl_buffer_size 4k;

# Disable weak SSL/TLS versions (belt and suspenders)
# Note: Let's Encrypt options-ssl-nginx.conf already sets this to TLSv1.2+
# This is an additional safeguard in case that file is modified
ssl_protocols TLSv1.2 TLSv1.3;

# Disable TLS 1.3 0-RTT (Zero Round Trip Time)
# Security Rule 17: Prevent Replay Attacks
# 0-RTT allows faster TLS handshakes but is vulnerable to replay attacks
# where an attacker can resend captured requests
ssl_early_data off;

# ========================================
# Notes
# ========================================
# - OCSP stapling caches OCSP responses for faster SSL handshakes
# - Reduces load on Certificate Authority OCSP responders
# - Improves privacy (client doesn't contact CA directly)
# - 4k buffer size is optimal for most certificates
# - Cloudflare (1.1.1.1) and Google (8.8.8.8) are reliable DNS resolvers
