# ========================================
# Fail2ban Jail Configuration for WordPress
# ========================================
# File: /etc/fail2ban/jail.d/wordpress.conf
#
# This configuration protects WordPress sites against:
# - wp-login.php brute force attacks
# - wp-admin brute force attempts
# - XML-RPC abuse
# - WordPress enumeration attacks
#
# Installation:
# 1. Copy to /etc/fail2ban/jail.d/wordpress.conf
# 2. Copy filter files to /etc/fail2ban/filter.d/
# 3. Restart fail2ban: sudo systemctl restart fail2ban
# 4. Check status: sudo fail2ban-client status wordpress-auth

[wordpress-auth]
enabled = true
port = http,https
filter = wordpress-auth
logpath = /var/log/nginx/*-access.log
maxretry = 5
findtime = 600
bantime = 3600
action = iptables-multiport[name=wordpress-auth, port="http,https", protocol=tcp]

[wordpress-hard]
enabled = true
port = http,https
filter = wordpress-hard
logpath = /var/log/nginx/*-access.log
maxretry = 3
findtime = 300
bantime = 7200
action = iptables-multiport[name=wordpress-hard, port="http,https", protocol=tcp]

[wordpress-xmlrpc]
enabled = true
port = http,https
filter = wordpress-xmlrpc
logpath = /var/log/nginx/*-access.log
maxretry = 2
findtime = 60
bantime = 3600
action = iptables-multiport[name=wordpress-xmlrpc, port="http,https", protocol=tcp]

# Configuration Details:
#
# wordpress-auth: Failed login attempts
# - maxretry: 5 attempts
# - findtime: 10 minutes window
# - bantime: 1 hour ban
#
# wordpress-hard: Critical attacks (admin enumeration, config access)
# - maxretry: 3 attempts
# - findtime: 5 minutes window
# - bantime: 2 hours ban
#
# wordpress-xmlrpc: XML-RPC abuse
# - maxretry: 2 attempts
# - findtime: 1 minute window
# - bantime: 1 hour ban
