# ========================================
# Fail2ban Filter - WordPress Authentication
# ========================================
# File: /etc/fail2ban/filter.d/wordpress-auth.conf
#
# Detects failed WordPress login attempts via wp-login.php

[Definition]

# Detect failed login via POST to wp-login.php
failregex = ^<HOST> .* "POST /wp-login\.php.* HTTP/.*" (403|401|429)

# Detect WordPress login page access with failed password
            ^<HOST> .* "POST /wp-login\.php.*log=.*" HTTP/.*" 200

# Ignore successful logins
ignoreregex = .*/wp-admin/.*

# Testing:
# fail2ban-regex /var/log/nginx/clemence-access.log /etc/fail2ban/filter.d/wordpress-auth.conf
