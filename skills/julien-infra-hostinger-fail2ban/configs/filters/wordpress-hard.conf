# ========================================
# Fail2ban Filter - WordPress Hard Attacks
# ========================================
# File: /etc/fail2ban/filter.d/wordpress-hard.conf
#
# Detects serious WordPress attack attempts

[Definition]

# Attempts to access wp-config.php
failregex = ^<HOST> .* "GET /wp-config\.php.* HTTP/.*"

# User enumeration attempts (?author=)
            ^<HOST> .* "GET /\?author=[0-9]+ HTTP/.*"

# Attempts to access debug.log
            ^<HOST> .* "GET /wp-content/debug\.log.* HTTP/.*"

# Attempts to access readme/license files (recon)
            ^<HOST> .* "GET /(readme|license|changelog)\.txt.* HTTP/.*"

# Scanning for backup files
            ^<HOST> .* "GET /.*\.(sql|zip|tar|gz|bak|backup).* HTTP/.*"

# Direct access to PHP files in uploads
            ^<HOST> .* "GET /wp-content/uploads/.*\.php.* HTTP/.*" 403

ignoreregex =

# Testing:
# fail2ban-regex /var/log/nginx/clemence-access.log /etc/fail2ban/filter.d/wordpress-hard.conf
